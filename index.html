<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>V√≤ng quay C√¢u h·ªèi To√°n</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #74ebd5, #ACB6E5);
      margin: 0; padding: 0; text-align: center; color: #333;
    }
    .step { display: none; margin-top: 40px; }
    .step.active { display: block; }
    button {
      padding: 12px 25px; margin-top: 20px; border: none; border-radius: 10px;
      background: linear-gradient(45deg, #ff4e50, #f9d423); color: white; font-size: 16px;
      cursor: pointer; transition: 0.3s; box-shadow: 0 6px 15px rgba(0,0,0,0.2);
    }
    button:hover { transform: scale(1.05); box-shadow: 0 10px 25px rgba(0,0,0,0.3); }
    .wheel-container { position: relative; width: 500px; height: 500px; margin: 20px auto; }
    canvas { border-radius: 50%; box-shadow: 0 8px 20px rgba(0,0,0,0.3); }
    .pointer {
      position: absolute; top: -20px; left: 50%; transform: translateX(-50%);
      width: 0; height: 0; border-left: 20px solid transparent; border-right: 20px solid transparent;
      border-bottom: 40px solid red;
    }
    #resultText { margin-top: 25px; font-size: 1.2em; font-weight: bold; color: #222; }
  </style>
</head>
<body>
  <!-- B∆∞·ªõc 1 -->
  <div id="step1" class="step active">
    <h2>B·∫°n ƒëang h·ªçc l·ªõp m·∫•y?</h2>
    <select id="classSelect">
      <option value="">--Ch·ªçn l·ªõp--</option>
      <option value="6">L·ªõp 6</option>
      <option value="7">L·ªõp 7</option>
      <option value="8">L·ªõp 8</option>
    </select>
    <br>
    <button onclick="startWheel()">B·∫Øt ƒë·∫ßu</button>
  </div>

  <!-- B∆∞·ªõc 2 -->
  <div id="step2" class="step">
    <h2>V√≤ng quay c√¢u h·ªèi To√°n l·ªõp <span id="classTitle"></span></h2>
    <div class="wheel-container">
      <div class="pointer"></div>
      <canvas id="wheelCanvas" width="500" height="500"></canvas>
    </div>
    <button id="spinBtn">Quay ngay!</button>
    <p id="resultText"></p>
  </div>

  <script>
    const mathQuestions = {
      "6": [
        "Vi·∫øt s·ªë t·ª± nhi√™n nh·ªè nh·∫•t c√≥ ba ch·ªØ s·ªë kh√°c nhau.",
        "Ph√¢n s·ªë n√†o l·ªõn h∆°n: 3/5 hay 4/7?",
        "T√≠nh gi√° tr·ªã c·ªßa 36 : 9 + 25.",
        "M·ªôt h√¨nh ch·ªØ nh·∫≠t c√≥ chi·ªÅu d√†i 12 cm, chi·ªÅu r·ªông 8 cm. Chu vi b·∫±ng bao nhi√™u?",
        "Vi·∫øt s·ªë th·∫≠p ph√¢n b·∫±ng ph√¢n s·ªë 7/10.",
        "Trong c√°c s·ªë 45, 60, 75 s·ªë n√†o chia h·∫øt cho 9?",
        "M·ªôt h√¨nh vu√¥ng c√≥ c·∫°nh 5 cm. Di·ªán t√≠ch b·∫±ng bao nhi√™u?",
        "Vi·∫øt h·ªón s·ªë 3 2/5 d∆∞·ªõi d·∫°ng ph√¢n s·ªë.",
        "Tr√™n tia s·ªë, ƒëi·ªÉm n√†o bi·ªÉu di·ªÖn s·ªë 2/3?",
        "Vi·∫øt ba s·ªë nguy√™n li√™n ti·∫øp."
      ],
      "7": [
        "Gi√° tr·ªã c·ªßa 2x + 5 khi x = -3 l√† bao nhi√™u?",
        "T√¨m nghi·ªám c·ªßa ph∆∞∆°ng tr√¨nh: 3x - 7 = 5.",
        "M·ªôt tam gi√°c c√≥ c√°c g√≥c 40¬∞, 60¬∞. G√≥c c√≤n l·∫°i b·∫±ng bao nhi√™u?",
        "V·∫Ω ƒë·ªì th·ªã h√†m s·ªë y = 2x.",
        "Ph√¢n t√≠ch ƒëa th·ª©c x^2 + 5x th√†nh nh√¢n t·ª≠.",
        "So s√°nh hai ph√¢n s·ªë 5/8 v√† 7/12.",
        "M·ªôt h√¨nh b√¨nh h√†nh c√≥ ƒë√°y 10 cm, chi·ªÅu cao 6 cm. Di·ªán t√≠ch b·∫±ng bao nhi√™u?",
        "T√¨m x: 2(x-3) = 10.",
        "Cho t·ªâ l·ªá th·ª©c 3/x = 9/12. T√¨m x.",
        "S·ªë ƒë·ªëi c·ªßa s·ªë -15 l√† bao nhi√™u?"
      ],
      "8": [
        "T√≠nh gi√° tr·ªã c·ªßa bi·ªÉu th·ª©c: (x+3)(x-3).",
        "R√∫t g·ªçn ph√¢n th·ª©c: (x^2-9)/(x+3).",
        "Cho ph∆∞∆°ng tr√¨nh 2x + 5 = 0. T√¨m nghi·ªám.",
        "M·ªôt h√¨nh thang c√≥ ƒë√°y l·ªõn 12 cm, ƒë√°y nh·ªè 8 cm, chi·ªÅu cao 5 cm. Di·ªán t√≠ch b·∫±ng bao nhi√™u?",
        "T√¨m nghi·ªám c·ªßa h·ªá ph∆∞∆°ng tr√¨nh: x+y=7, x-y=1.",
        "T√≠nh chu vi h√¨nh tr√≤n c√≥ b√°n k√≠nh 7 cm. (L·∫•y œÄ = 3,14).",
        "R√∫t g·ªçn bi·ªÉu th·ª©c: (x^2-4)/(x-2).",
        "Cho g√≥c ·ªü t√¢m b·∫±ng 60¬∞. S·ªë ƒëo cung tr√≤n ch·∫Øn g√≥c ƒë√≥ l√† bao nhi√™u ƒë·ªô?",
        "M·ªôt v·∫≠t th·ªÉ c√≥ th·ªÉ t√≠ch h√¨nh l·∫≠p ph∆∞∆°ng c·∫°nh 4 cm l√† bao nhi√™u?",
        "T√¨m x: x/5 = 12/15."
      ]
    };

    let currentClass = null;
    let segments = [];
    let colors = [];
    let startAngle = 0;
    let arc = 0;
    let spinAngle = 0;
    let spinTime = 0;
    let spinTimeTotal = 0;
    let spinning = false;

    const canvas = document.getElementById("wheelCanvas");
    const ctx = canvas.getContext("2d");
    const resultText = document.getElementById("resultText");

    function startWheel() {
      currentClass = document.getElementById("classSelect").value;
      if (!currentClass) { alert("H√£y ch·ªçn l·ªõp!"); return; }
      
      document.getElementById("step1").classList.remove("active");
      document.getElementById("step2").classList.add("active");
      
      document.getElementById("classTitle").innerText = currentClass;
      segments = mathQuestions[currentClass];
      colors = segments.map((_, i) => i % 2 === 0 ? "#FF6B6B" : "#4D96FF");
      arc = Math.PI * 2 / segments.length;
      drawWheel();
    }

    function drawWheel() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      for (let i = 0; i < segments.length; i++) {
        let angle = startAngle + i * arc;
        ctx.fillStyle = colors[i];
        ctx.beginPath();
        ctx.moveTo(250, 250);
        ctx.arc(250, 250, 250, angle, angle + arc);
        ctx.closePath();
        ctx.fill();
        ctx.strokeStyle = "white";
        ctx.lineWidth = 2;
        ctx.stroke();
        ctx.save();
        ctx.fillStyle = "#fff";
        ctx.font = "bold 14px Segoe UI";
        ctx.translate(250 + Math.cos(angle + arc / 2) * 150, 250 + Math.sin(angle + arc / 2) * 150);
        ctx.rotate(angle + arc / 2 + Math.PI / 2);
        let text = segments[i];
        ctx.fillText(text.length > 30 ? text.slice(0,30)+"..." : text, -ctx.measureText(text).width / 2, 0);
        ctx.restore();
      }
    }

    function rotateWheel() {
      spinTime += 20;
      if (spinTime >= spinTimeTotal) { stopRotateWheel(); return; }
      let spinAngleChange = easeOut(spinTime, 0, spinAngle, spinTimeTotal);
      startAngle += (spinAngleChange * Math.PI / 180);
      drawWheel();
      requestAnimationFrame(rotateWheel);
    }

    function stopRotateWheel() {
      let degrees = startAngle * 180 / Math.PI + 90;
      let arcd = 360 / segments.length;
      let index = Math.floor((360 - (degrees % 360)) / arcd) % segments.length;
      resultText.innerHTML = "üìò " + segments[index];
      spinning = false;
    }

    function easeOut(t, b, c, d) {
      let ts = (t/=d)*t; let tc = ts*t;
      return b+c*(tc + -3*ts + 3*t);
    }

    function spinWheel() {
      if (spinning) return;
      spinning = true;
      resultText.textContent = "";
      spinAngle = Math.random() * 10 + 10;
      spinTime = 0;
      spinTimeTotal = 3000 + Math.random() * 2000;
      rotateWheel();
    }

    document.getElementById("spinBtn").addEventListener("click", spinWheel);
  </script>
</body>
</html>
